 apiVersion :  v1
 kind :  ConfigMap
 metadata :
   name :  sops-plugin-config
   namespace :  argocd
 data :
   plugin.yaml :  | 
     apiVersion :  argoproj.io/v1alpha1 
     kind :  ConfigManagementPlugin 
     metadata :
       name :  sops-plugin 
     spec :
       version :  v1.0 
       init :
         command :  [sh, -c, 'echo "Initializing Plugin SOPS"'] 
       generate :
         command: [ sh, -c, "bash ./decrypt_sops_secrets.sh && helm template ${ARGOCD_ENV_ARGOCD_APP_NAME} . --set image.repository=${ARGOCD_ENV_DOCKER_IMAGE_REGISTRY} --set image.tag=${ARGOCD_ENV_DOCKER_IMAGE_TAG} -f secrets/development/secrets.decrypted.yaml "  ]
       discover :
         fileName : " ./values.yaml "
         
